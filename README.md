# Лабораторная работа №2.

Численное решение задачи Коши для уравнения высшего порядка.

Уравнение: $4yy'' + (y^2 - 9)(y')^6 + (y')^2 = 0$ при начальном условии $y(0) = 1$ и $y'(0) = -\frac{1}{2}$.

Полная (технически корректная) версия находится в [этом репозитории на Github](https://github.com/FB1-ITMO-CT/sem03-diff-eq-lab-002).

Автор: Бородулин Фёдор, M3238

## Аналитическое решение

### Попробуем метод понижения порядка

Подстановка $p = y'$ и $y'' = p \frac{dp}{dy}$ приводит к уравнению $4yp \frac{dp}{dy} + (y^2 - 9)p^6 + p^2 = 0$
$p \neq 0$ в окрестности $x = 0$, сокращаем: $4y \frac{dp}{dy} + (y^2 - 9)p^5 + p = 0$

### Линейное уравнение относительно $z = p^{-4}$

$\frac{dz}{dy} - \frac{1}{y}z = \frac{y^2 - 9}{y} \Rightarrow z = y^2 + 9 + Cy$

Применим начальное условие и получим $C = 6 \Rightarrow (y')^{-4} = (y + 3)^2$ и, с учётом знака, $y' = -\frac{1}{\sqrt{y + 3}}$

### Преобразуем $y'$ и интегрируем

$\frac{dy}{dx} = -\frac{1}{\sqrt{y + 3}} \Leftrightarrow \sqrt{y + 3}dy = -dx \Rightarrow \frac{2}{3}(y + 3)^{3/2} = -x + C$

Применим начальное условие и получим $C = \frac{16}{3} \Rightarrow y = \left(8 - \frac{3}{2}x\right)^{2/3} - 3$
Решение определено при $x \leq \frac{16}{3}$

## Адаптация численного метода

Необходимо адаптировать численный метод, применявшийся для решения $y' = F(x, y) \Leftrightarrow F(x, y, y') = 0$, для случая $F(x, y, y', y'') = 0 \Leftrightarrow y'' = F(x, y, y')$. (В нашем случае $y'' = F(x, y, y') \Rightarrow F(x, y, y') = -\dfrac{(y^2 - 9)(y')^6 + (y')^2}{4y}$)

В каждой точке нам известен вектор $(x, y, y')$ вместо $(x, y)$, $x$ так же увеличивается на шаг итерации, а $y$ и $y'$ хочется обработать как отдельные уравнения первого порядка. Мы знаем $y'$ в точке (это часть координат), так что можем использовать его, а старшую степень посчитаем из уравнения. Итого, необходимо сделать методы аппроксимации векторными, а в функции производной возвращать суффикс координат как префикс вектора.

Для сравнения были реализованы две дополнительные версии метода: 4-ого порядка с модифицированными коэффициентами и 5-ого порядка.

## Графики

Оба изображения — GIF, пробегающие по разной точности симуляции.

### Простой результат

<img src="./examples/animated.gif" alt="animated" style="zoom:67%;" />

Заметно, что при накоплении отклонения от истинного решения все методы резко "убегают" на бесконечность независимо от порядка, так как на подобное случайное отклонение влияет попадание в конкретные точки, зависящее от точности совершенно нелинейно, а также, в определённой степени, даже погрешность чисел с плавающей точкой.

Основной причиной я бы назвал вхождение в формулу значений суммарно в восьмой степени (в $(y^2 - 9)(y')^6$), что приводит к огромной скорости роста/убывания.

### С погрешностью, на разумном диапазоне

<img src="./examples/delta.gif" alt="animated" style="zoom:67%;" />

Здесь был взят малый отрезок графика для исключения влияния специфики функции. В таком сценарии точность методов вполне соответствует ожиданиям.

## Программная часть

### Исходный код

Файлы исходного кода на языке Python находятся в директории `./src`.

### Сборка и запуск проекта

Для работы с зависимостями используется инструмент [uv](https://github.com/astral-sh/uv):

- Создайте виртуальное окружение Python с необходимой для проекта версией интерпретатора 3.14: `uv venv --python 3.14 .venv`.

- Включите созданное окружение `./.venv/Scripts/activate` и синхронизируйте зависимости `uv sync --active`.

- Теперь доступен CLI интерфейс проекта `run`, вызывающий функцию `src.main:main`.
  Можно запустить `run --help` для получения справки по аргументам командной строки.

## Лицензия :)

Copyright 2025 Borodulin Fedor

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file, this project source code and examples except
in compliance with the License. You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

